var changePwd={init:function(){changePwd.bind()},options:{wait:60,canGetVerifyCode:!0,pwd:/^(?![^a-zA-Z]+$)(?!\\D+$).{6,20}$/},getverificationCode:function(e){$.ajax({data:{mobile:e,type:2},type:"GET",url:WX_ROOT+"wechat/sendMessage",beforeSend:function(){},success:function(e){var t=JSON.parse(e);"600"==t.type?(common.tips({msg:"发送"+t.msg}),changePwd.time()):common.tips({msg:t.msg})}})},time:function(){var e=$(".getCodeBtn2 ");0==changePwd.options.wait?(changePwd.options.canGetVerifyCode=!0,e.text("获取验证码"),changePwd.options.wait=60):(changePwd.options.canGetVerifyCode=!1,e.text("重新发送("+changePwd.options.wait+")s"),changePwd.options.wait--,setTimeout(function(){changePwd.time()},1e3))},changePwdFun:function(e,t,n){$.ajax({data:{mobile:e,random:t,password:n},type:"POST",url:WX_ROOT+"usercenter/updatePwd",beforeSend:function(){common.alert({msg:"请稍后..",stayTime:-1})},success:function(e){var t=JSON.parse(e.data);common.alert("hide"),600==t.msgCode?common.tips({msg:"密码已修改，请重新登录",stayTime:3e3,callback:function(){window.location.href=WX_ROOT+"base/login"}}):common.tips({msg:t.message})}})},bind:function(){var e=localStorage.getItem("userInfo");if(e){var t=JSON.parse(e);$(".telInput").val(t.mobile)}$(".toLoginBtn").on("tap",function(){window.location.href=WX_ROOT+"base/login?shareId="+common.getUrlParameter("shareId")+"&inviteId="+common.getUrlParameter("inviteId")+"&redirect_url="+WX_ROOT+"carInsurance/index"}),$(".getCodeBtn2").on("tap",function(){localStorage.getItem("userInfo");if(changePwd.options.canGetVerifyCode){var e=$(".telInput").val();changePwd.getverificationCode(e)}}),$("#changePwd").on("tap",function(){var e=$(".verifyInput").val(),t=$(".passwordInput").val(),n=!1;if(changePwd.options.pwd.test(t)&&(n=!0),n){var o=$(".telInput").val();changePwd.changePwdFun(o,e,t)}else common.tips({msg:"密码格式为6-16位的字母与数字的组合"})})}};$(document).ready(function(){1==localStorage.getItem("forgetPwd")?$(".headerSpan").text("找回密码"):$(".toLoginBtn").addClass("dis_none");var e=localStorage.getItem("mobile");e&&$(".telInput").text(e),changePwd.init()});