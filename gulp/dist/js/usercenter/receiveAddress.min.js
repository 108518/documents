var receiveAddress={init:function(){receiveAddress.registerHelper();var e=localStorage.getItem("token");e&&receiveAddress.getUserAddress(e),receiveAddress.bind()},registerHelper:function(){Handlebars.registerHelper("isDefault",function(e){return 1==e?"color-red":"color-white"})},getUserAddress:function(e){$.ajax({async:!1,data:{token:e,flag:1},type:"GET",url:WX_ROOT+"usercenter/userAddress",beforeSend:function(){common.alert({stayTime:-1})},success:function(e){if(e){sessionStorage.setItem("userAddress",e);var t=JSON.parse(e);if(600==t.msgCode)if(t.detail&&t.detail.length>0){var s=Handlebars.compile($("#listDiv").html());$(".contentDiv").html(s(t.detail))}else $(".contentDiv").text("亲暂时还没有收货地址哦，请点击右上角添加一个吧！").addClass("no-add-data");else 610==t.msgCode&&common.tips({msg:"身份验证过期，请重新登录！",updateText:!0,stayTime:2e3,callback:function(){localStorage.setItem("toRegistPage",window.location.href),window.location.href=WX_ROOT+"base/login"}})}common.alert({show:!1})}})},deleteAddress:function(e,t){$.ajax({data:{token:e,flag:2,setType:3,id:t},type:"POST",url:WX_ROOT+"usercenter/userAddress",success:function(e){$("#address-panel"+t).addClass("dis_none"),common.tips({msg:"删除成功"}),common.close($(".delSection"))}})},options:{},bind:function(){$(".addSpan").on("touchend",function(){sessionStorage.setItem("updateUserFlag",5),window.location.href=WX_ROOT+"usercenter/perfectPersonalData"}),$(".delete").on("touchend",function(e){common.showId($(".delSection")),$(".delSection").attr("data-id",$(e.currentTarget).attr("data-id")),e.stopPropagation(),e.preventDefault()}),$(".cancelDelBtn").on("touchend",function(){common.close($(".delSection"))}),$(".ensureDelBtn").on("touchend",function(){var e=localStorage.getItem("token"),t=$(".delSection").attr("data-id");e&&receiveAddress.deleteAddress(e,t)}),$(".edit").on("touchend",function(e){e.stopPropagation(),e.preventDefault();var t=JSON.parse(sessionStorage.getItem("userAddress")),s=$(e.currentTarget).attr("data-id");sessionStorage.setItem("updateUserFlag",5),$(t.detail).each(function(e,t){s==t.id&&localStorage.setItem("editData",JSON.stringify(t))}),window.location.href=WX_ROOT+"usercenter/perfectPersonalData"}),$(".address-panel").on("tap",function(e){var t=$(e.currentTarget).attr("data-addressId");localStorage.setItem("addressId",t);var s=JSON.parse(sessionStorage.getItem("userAddress"));$(s.detail).each(function(e,s){t==s.id&&sessionStorage.setItem("selectedAddress",JSON.stringify(s))});var n=sessionStorage.getItem("toAdressPage");n&&(window.location.href=n)})}};$(document).ready(function(){receiveAddress.init()});