var center={init:function(){center.tab(),center.initData(),center.registerHelper(),center.bind()},options:{token:localStorage.getItem("token"),userId:null,height:window.innerHeight-458,status:localStorage.getItem("policyStatus")},tab:function(){var t=new fz.Scroll(".ui-tab",{role:"tab",autoplay:!1,interval:3e3});t.on("beforeScrollStart",function(t,e){}),t.on("scrollEnd",function(t){var e=0;0==t?(e="",localStorage.setItem("policyStatus","all")):1==t?(e=0,localStorage.setItem("policyStatus",0)):2==t?(e=3,localStorage.setItem("policyStatus",3)):3==t&&(e=4,localStorage.setItem("policyStatus",4)),center.getList(e,1e3)})},registerHelper:function(){Handlebars.registerHelper("status",function(t,e){return t=JSON.parse(t),0==t?"待支付":1==t?"已支付":2==t?"已出单":3==t?"已生效":4==t?"已终止":5==t?"已拒保":6==t?"已取消":void 0}),Handlebars.registerHelper("pic",function(t,e){return PIC_PATH+t}),Handlebars.registerHelper("payClass",function(t,e){return"0"==t||"3"==t||"4"==t||"5"==t||"6"==t?"":"dis_none"}),Handlebars.registerHelper("tellClass",function(t,e){return"3"==t?"":"dis_none"}),Handlebars.registerHelper("notTellClass",function(t,e){return"0"==t?"":"dis_none"}),Handlebars.registerHelper("delClass",function(t,e){return"4"==t||"5"==t||"6"==t?"":"dis_none"}),Handlebars.registerHelper("jq",function(t,e){return""==t||null==t?"dis_none":""}),Handlebars.registerHelper("sy",function(t,e){return""==t||null==t?"dis_none":""})},initData:function(){var t=localStorage.getItem("policyStatus");3==t?(localStorage.setItem("policyStatus",3),$(".ui-tab-nav li:nth-of-type(3)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content li:nth-of-type(3)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content").css({transform:"translate(-1280px, 0px)","-webkit-transform":"translate(-1280px, 0px)"}),center.getList(t,1e3)):4==t?(localStorage.setItem("policyStatus",4),$(".ui-tab-nav li:nth-of-type(4)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content li:nth-of-type(4)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content").css({transform:"translate(-1920px, 0px)","-webkit-transform":"translate(-1920px, 0px)"}),center.getList(t,1e3)):0==t?(localStorage.setItem("policyStatus",0),$(".ui-tab-nav li:nth-of-type(2)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content li:nth-of-type(2)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content").css({transform:"translate(-640px, 0px)","-webkit-transform":"translate(-640px, 0px)"}),center.getList(t,1e3)):(localStorage.setItem("policyStatus","all"),$(".ui-tab-nav li:nth-of-type(1)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content li:nth-of-type(1)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content").css({transform:"translate(0px, 0px)","-webkit-transform":"translate(0px, 0px)"}),center.getList("",1e3))},getList:function(t,e){var a=e||1,n=10;$.ajax({data:{token:center.options.token,userId:center.options.userId,type:t,pageNumber:a,pageSize:n},type:"get",url:WX_ROOT+"insurance/getOrderList",beforeSend:function(){common.alert({stayTime:-1})},success:function(t){if(t)try{var e=JSON.parse(t),a=[],n=0;if(e&&600==e.code)if(e.data.list.length>0){for(var r=Handlebars.compile($("#listDiv2").html()),o=0;o<e.data.list.length;o++){var i={},s=[];i.id=e.data.list[o].id,i.paulId=e.data.list[o].paulId,i.pid=e.data.list[o].pid,i.pname=e.data.list[o].pname,i.STATUS=e.data.list[o].STATUS,i.type=e.data.list[o].type,i.imageUrl=e.data.list[o].imageUrl,i.created=e.data.list[o].created,i.feeTotal=e.data.list[o].feeTotal,i.ordersId=e.data.list[o].ordersId,i.orderType=e.data.list[o].orderType,i.telephone=e.data.list[o].telephone,i.flag=JSON.stringify(s),i.productCount=e.data.list[o].pcount,i.productPrice=e.data.list[o].pprice,a.push(i),n++}0==n&&common.tips({msg:"没有您的车险订单"}),3==localStorage.getItem("policyStatus")?$(".workDiv").html(r(a)):4==localStorage.getItem("policyStatus")?$(".finishDiv").html(r(a)):0==localStorage.getItem("policyStatus")?$(".waitDiv").html(r(a)):$(".allDiv").html(r(a))}else common.tips({msg:"没有数据"});else common.tips({msg:e.msg})}catch(t){}common.alert({show:!1})}})},delOrder:function(t,e){var a={};a.oid=t,a.token=e,$.ajax({url:WX_CORS,data:{url:"rest/app/order/cancel",params:JSON.stringify(a)},type:"POST",success:function(t){600==t.code?(common.close($(".delSection")),window.location.href=window.location.href):common.error()},timeout:3e3})},delPolicy:function(t,e){var a={};a.oid=t,a.token=e,$.ajax({url:WX_CORS,data:{url:"rest/app/order/delete",params:JSON.stringify(a)},type:"POST",success:function(t){600==t.code?(common.close($(".delSection")),window.location.href=window.location.href):common.error()},timeout:3e3})},bind:function(){$(".insuranceDiv").css("height",center.options.height),$(".workDiv ").off().on("tap",".orderInfoDiv",function(){localStorage.setItem("policyStatus","all");var t=$(this).parents("li").attr("data-id"),e=$(this).parents("li").attr("data-ordertype"),a=$(this).parents("li").attr("data-phone");sessionStorage.setItem("myInsurancePolicy_id",t),1==e?window.location.href=WX_ROOT+"usercenter/insureDetail":window.location.href=WX_ROOT+"usercenter/notCarInsureDetail?myInsurancePolicy_id="+t+"&phone="+a}),$(".finishDiv ").off().on("tap",".orderInfoDiv",function(){localStorage.setItem("policyStatus","all");var t=$(this).parents("li").attr("data-id"),e=$(this).parents("li").attr("data-ordertype"),a=$(this).parents("li").attr("data-phone");sessionStorage.setItem("myInsurancePolicy_id",t),1==e?window.location.href=WX_ROOT+"usercenter/insureDetail":window.location.href=WX_ROOT+"usercenter/notCarInsureDetail?myInsurancePolicy_id="+t+"&phone="+a}),$(".waitDiv ").off().on("tap",".orderInfoDiv",function(){localStorage.setItem("policyStatus","all");var t=$(this).parents("li").attr("data-id"),e=$(this).parents("li").attr("data-ordertype"),a=$(this).parents("li").attr("data-phone");sessionStorage.setItem("myInsurancePolicy_id",t),1==e?window.location.href=WX_ROOT+"usercenter/insureDetail":window.location.href=WX_ROOT+"usercenter/notCarInsureDetail?myInsurancePolicy_id="+t+"&phone="+a}),$(".allDiv ").off().on("tap",".orderInfoDiv",function(){localStorage.setItem("policyStatus","all");var t=$(this).parents("li").attr("data-id"),e=$(this).parents("li").attr("data-ordertype"),a=$(this).parents("li").attr("data-phone");sessionStorage.setItem("myInsurancePolicy_id",t),1==e?window.location.href=WX_ROOT+"usercenter/insureDetail":window.location.href=WX_ROOT+"usercenter/notCarInsureDetail?myInsurancePolicy_id="+t+"&phone="+a}),$("body").on("tap",".rightBtn",function(){var t=$(this).parents("li").attr("data-ordersid"),e=$(this).parents("li").attr("data-proid"),a=$(this).parents("li").attr("data-productPrice"),n=$(this).parents("li").attr("data-productCount"),r=$(this).parents("li").attr("data-productName");4==e||5==e||6==e?window.location.href=WX_ROOT+"pay/tBbpayInfo?productPrice="+a+"&productCount="+n+"&productId="+t+"&productName="+r+"&createPay=0":window.location.href=APP_ROOT+"pay/kqPay?ordersId="+t}),$("body").on("tap",".cancelPayBtn",function(){common.showId($(".delSection")),$(".delBtnDiv p:nth-of-type(2)").addClass("ensureCancelBtn").removeClass("ensureDelBtn"),$(".delSection").attr("data-id",$(this).parents("li").attr("data-id")),$(".cancelDelBtn").on("tap",function(){common.close($(".delSection"))}),$(".ensureCancelBtn").on("tap",function(){var t=$(this).parents(".delSection").attr("data-id");center.delOrder(t,center.options.token)})}),$("body").on("tap",".deletePolicyBtn",function(){$(".bgDiv p.titleP").text("确定删除此订单吗"),$(".delBtnDiv p:nth-of-type(2)").addClass("ensureDelBtn").removeClass("ensureCancelBtn"),common.showId($(".delSection")),$(".delSection").attr("data-id",$(this).parents("li").attr("data-id")),$(".cancelDelBtn").on("tap",function(){common.close($(".delSection"))}),$(".ensureDelBtn").on("tap",function(){var t=$(this).parents(".delSection").attr("data-id");center.delPolicy(t,center.options.token)})})}};$(document).ready(function(){var t=localStorage.getItem("userInfo");if(t)try{var e=JSON.parse(t);e&&e.id?(center.options.userId=e.id,center.init()):window.location.href=WX_ROOT+"info/500"}catch(t){window.location.href=WX_ROOT+"info/500"}else window.location.href=WX_ROOT+"base/login"});