var center={init:function(){center.bind(),center.getUserInfo()},getUserInfo:function(){try{var e=JSON.parse(localStorage.getItem("userInfo"));e.realName?$("#userName").html(e.realName):e.userName&&$("#userName").html(e.username),$("#emailName").html(e.email),$("#headerImg").attr("src",e.image||""),$("#userMobile").html(e.mobile),$(".sexSeclect").val(e.sex),$(".certificateSeclect").val(e.idCardType),$(".addressInput").html(e.address),$("#idCard").html(e.idCard)}catch(e){common.tips({msg:"没有登录！",callback:function(){window.location.href=WX_ROOT+"base/login"}})}},options:{height:window.innerHeight-458},bind:function(){$(".insuranceDiv").css("height",center.options.height),$(".changePwd").on("tap",function(){localStorage.setItem("forgetPwd",0),window.location.href=WX_ROOT+"usercenter/changePwd"}),$(".address").on("tap",function(){window.location.href=WX_ROOT+"usercenter/receiveAddress"}),$("#userNameDiv").on("tap",function(){window.location.href=WX_ROOT+"usercenter/perfectPersonalData",sessionStorage.setItem("updateUserFlag",2)}),$("#emailDiv").on("tap",function(){window.location.href=WX_ROOT+"usercenter/perfectPersonalData",sessionStorage.setItem("updateUserFlag",3)}),$("#idcardNumber").on("tap",function(){window.location.href=WX_ROOT+"usercenter/perfectPersonalData",sessionStorage.setItem("updateUserFlag",4)});var e=localStorage.getItem("token");$(".sexSeclect").on("change",function(){var t=$(this).val();$.ajax({data:{sex:t,token:e,flag:5},type:"post",url:WX_ROOT+"usercenter/updateUserInfo",success:function(t){common.tips({msg:"修改成功",callback:function(){common.queryUserByToken(e)}})}})}),$(".logout").on("tap",function(){$.ajax({data:{token:e},type:"post",url:WX_ROOT+"wechat/doLogout",success:function(e){if(e){var t=JSON.parse(e.data).msgCode;600==t&&common.tips({msg:"注销成功",callback:function(){var e=localStorage.getItem("mobile");localStorage.clear(),sessionStorage.clear(),localStorage.setItem(CLEAR_FLAG_KEY,new Date(ENV_DATE).getTime()),e&&localStorage.setItem("mobile",e),window.location.href=WX_ROOT+"base/login"}})}}})})}};$(document).ready(function(){center.init()});
var changePwd={init:function(){changePwd.bind()},options:{wait:60,canGetVerifyCode:!0,pwd:/^(?![^a-zA-Z]+$)(?!\\D+$).{6,20}$/},getverificationCode:function(e){$.ajax({data:{mobile:e,type:2},type:"GET",url:WX_ROOT+"wechat/sendMessage",beforeSend:function(){},success:function(e){var t=JSON.parse(e);"600"==t.type?(common.tips({msg:"发送"+t.msg}),changePwd.time()):common.tips({msg:t.msg})}})},time:function(){var e=$(".getCodeBtn2 ");0==changePwd.options.wait?(changePwd.options.canGetVerifyCode=!0,e.text("获取验证码"),changePwd.options.wait=60):(changePwd.options.canGetVerifyCode=!1,e.text("重新发送("+changePwd.options.wait+")s"),changePwd.options.wait--,setTimeout(function(){changePwd.time()},1e3))},changePwdFun:function(e,t,n){$.ajax({data:{mobile:e,random:t,password:n},type:"POST",url:WX_ROOT+"usercenter/updatePwd",beforeSend:function(){common.alert({msg:"请稍后..",stayTime:-1})},success:function(e){var t=JSON.parse(e.data);common.alert("hide"),600==t.msgCode?common.tips({msg:"密码已修改，请重新登录",stayTime:3e3,callback:function(){window.location.href=WX_ROOT+"base/login"}}):common.tips({msg:t.message})}})},bind:function(){var e=localStorage.getItem("userInfo");if(e){var t=JSON.parse(e);$(".telInput").val(t.mobile)}$(".toLoginBtn").on("tap",function(){window.location.href=WX_ROOT+"base/login?shareId="+common.getUrlParameter("shareId")+"&inviteId="+common.getUrlParameter("inviteId")+"&redirect_url="+WX_ROOT+"carInsurance/index"}),$(".getCodeBtn2").on("tap",function(){localStorage.getItem("userInfo");if(changePwd.options.canGetVerifyCode){var e=$(".telInput").val();changePwd.getverificationCode(e)}}),$("#changePwd").on("tap",function(){var e=$(".verifyInput").val(),t=$(".passwordInput").val(),n=!1;if(changePwd.options.pwd.test(t)&&(n=!0),n){var o=$(".telInput").val();changePwd.changePwdFun(o,e,t)}else common.tips({msg:"密码格式为6-16位的字母与数字的组合"})})}};$(document).ready(function(){1==localStorage.getItem("forgetPwd")?$(".headerSpan").text("找回密码"):$(".toLoginBtn").addClass("dis_none");var e=localStorage.getItem("mobile");e&&$(".telInput").text(e),changePwd.init()});
var insureDetail={init:function(e){insureDetail.bind(e),insureDetail.registerHelper(),insureDetail.getInfo(e)},options:{},registerHelper:function(){Handlebars.registerHelper("status",function(e,n){return 0==e?"待支付":1==e?"已支付":2==e?"已出单":3==e?"已生效":4==e?"已终止":5==e?"已拒保":6==e?"已取消":void 0}),Handlebars.registerHelper("isTransfer",function(e,n){return 1==e?"是":0==e?"否":void 0}),Handlebars.registerHelper("class",function(e,n){return e&&"null"!=e?"":"dis_none"}),Handlebars.registerHelper("telclass",function(e,n){return 1==e?"":0==e?"dis_none":e==-1?"dis_none":void 0}),Handlebars.registerHelper("money",function(e,n){return e>0?"":"dis_none"}),Handlebars.registerHelper("payEndTime",function(e,n){return 0==e?"":"dis_none"}),Handlebars.registerHelper("causeP",function(e,n){return 5==e?"":"dis_none"}),Handlebars.registerHelper("endTime",function(e,n){var r=Math.floor((e-new Date)/1e3/60/60/24),t=Math.floor((e-new Date)/1e3/60/60%24);return r<=0?t+"小时":r+"天"+t+"小时"}),Handlebars.registerHelper("teltoCallclass",function(e,n){return 0==e?"":"dis_none"}),Handlebars.registerHelper("isUsedCoupon",function(e,n){return 1==e?"":"dis_none"}),Handlebars.registerHelper("deleteclass",function(e,n){return 4==e||5==e||6==e?"":"dis_none"})},getInfo:function(e){var n={jqInsurance:"交强险",travelTax:"车船税",clssInsurance:"车辆损失险",dszzrInsurance:"第三者责任险",qcdqInsurance:"全车盗抢险",blddpsInsurance:"玻璃单独破碎险",zrssInsurance:"自燃损失险",ryzrSjInsurance:"车上人员责任险-司机",ryzrCkInsurance:"车上人员责任险-乘客",csghInsurance:"车身划痕险",ssssInsurance:"涉水损失险",cstyInsurance:"车损无法找到第三方特约险"},r={mptySzInsurance:"三责",mptyCsInsurance:"车损",mptySjInsurance:"司机",mptyZrInsurance:"自燃",mptyHhInsurance:"划痕",mptyCkInsurance:"乘客",mptyDqInsurance:"盗抢"};$.ajax({data:{oid:e},type:"GET",url:WX_ROOT+"insurance/getOrderInfo",beforeSend:function(){common.alert({stayTime:-1})},success:function(e){var t=JSON.parse(e);if(600==t.msgCode){var s=[],a="";for(var i in t.detail.consultPrice){if("-1"!=t.detail.consultPrice[i]&&n[i]){var o={};o.name=n[i],o.money=t.detail.consultPrice[i+"Money"],"0"!=t.detail.consultPrice[i+"Money"]&&s.push(o)}"0"!=t.detail.consultPrice[i]&&"-1"!=t.detail.consultPrice[i]&&r[i]&&(a+=r[i]+"、")}var l="",c="";$(s).each(function(e,n){"交强险"==n.name||"车船税"==n.name?l+="<p>-"+n.name+n.money+"元</p>":c+="<p>-"+n.name+n.money+"元</p>"});var u=Handlebars.compile($("#infoDiv").html());$(".bigContentDiv").html(u(t.detail)),$(".jqFromPaul").html("交强险保障期间："+t.detail.consultPrice.jqFromPaul+" 至 "+t.detail.consultPrice.endJqFromPaul),$(".syFromPaul").html("商业险保障期间："+t.detail.consultPrice.syFromPaul+" 至 "+t.detail.consultPrice.endSyFromPaul),$(".jqxInsuranceP").html(l),$(".syInsuranceP").html(c),0!=t.detail.consultPrice.deductibleMoney&&$(".syInsuranceP").append("-不计免赔("+a.substr(0,a.length-1)+")"+t.detail.consultPrice.deductibleMoney+"元")}common.alert({show:!1})}})},delPolicy:function(e,n){var r={};r.oid=e,r.token=n,$.ajax({url:WX_CORS,data:{url:"rest/app/order/delete",params:JSON.stringify(r)},type:"POST",success:function(e){600==e.code?common.close($(".delSection")):common.error()},timeout:3e3})},bind:function(e){$("body").on("tap",".ideleteBtn",function(){$(".bgDiv p.titleP").text("确定删除此订单吗"),$(".delBtnDiv p:nth-of-type(2)").addClass("ensureDelBtn").removeClass("ensureCancelBtn"),common.showId($(".delSection")),$(".cancelDelBtn").on("tap",function(){common.close($(".delSection"))}),$(".ensureDelBtn").on("tap",function(){var n=e;insureDetail.delPolicy(n,localStorage.getItem("token"))})})}};$(document).ready(function(){var e="";e=common.getUrlParameter("myInsurancePolicy_id")?common.getUrlParameter("myInsurancePolicy_id"):sessionStorage.getItem("myInsurancePolicy_id"),e?insureDetail.init(e):common.tips({msg:"哎哟，出异常了！"})});
var luckyLottery={init:function(){luckyLottery.registerHelper(),luckyLottery.getCjMemberResultList(),luckyLottery.imgChange(),luckyLottery.runNews(),common.saveWeixinInfoToUser(window.location.href),luckyLottery.author(),luckyLottery.bind()},options:{signature:null,timestamp:null,nonceStr:null,appid:null,canLottery:!0},enterWxAuthor:function(){var e=localStorage.getItem("wxUserInfo");if(e)luckyLottery.init();else{var t=common.getUrlParameter("code");t?(common.getWxUserInfo(t),luckyLottery.init()):window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+WX_APPID+"&redirect_uri="+window.location.href+"&response_type=code&scope=snsapi_userinfo#wechat_redirect"}},runNews:function(){function e(){0==n?(t.eq(n).show(),n++):n==o?(t.eq(0).show(),n=1):(t.eq(n).show(),t.eq(n-1).hide(),n++)}var t=$(".ad ul li"),o=t.length,n=0;e(),setInterval(e,4e3)},imgChange:function(){setInterval(function(){var e="http://www.szqhflkj.cn/weixin/static/img/flag2.png",t=$(".flag img").attr("src");t==e?$(".flag img").attr("src",WX_STATIC+"img/flag1.png"):$(".flag img").attr("src",WX_STATIC+"img/flag2.png")},300)},registerHelper:function(){Handlebars.registerHelper("time",function(e,t){return new Date(parseInt(e)).toLocaleString().replace(/:\d{1,2}$/," ")}),Handlebars.registerHelper("nickname",function(e,t){return""==e||null==e?"--":e}),Handlebars.registerHelper("compare",function(e,t,o,n){if(arguments.length<3)throw new Error('Handlerbars Helper "compare" needs 2 parameters');var r={"==":function(e,t){return e==t},"===":function(e,t){return e===t},"!=":function(e,t){return e!=t},"!==":function(e,t){return e!==t},"<":function(e,t){return e<t},">":function(e,t){return e>t},"<=":function(e,t){return e<=t},">=":function(e,t){return e>=t},typeof:function(e,t){return typeof e==t}};if(!r[t])throw new Error('Handlerbars Helper "compare" doesn\'t know the operator '+t);var i=r[t](e,o);return i?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("headImg",function(e,t){return""==e||null==e?"http://www.szqhflkj.cn/weixin/static/img/logo.png":e}),Handlebars.registerHelper("date",function(e,t){return e.substr(5,11)})},lottery:function(e){luckyLottery.options.canLottery&&(luckyLottery.options.canLottery=!1,common.tips({msg:"活动已结束！",stayTime:4e3}))},initMemberEventLotteryNum:function(){var e=localStorage.getItem("token");e?$.ajax({type:"POST",url:WX_ROOT+"usercenter/queryUserLeftLotteryCount",dataType:"json",data:{token:localStorage.getItem("token")},cache:!1,success:function(e){var t=JSON.parse(e).detail;$(".lotteryNum").text(+-+t),0==t?$(".myRecordDiv p:nth-of-type(1)").html("您的抽奖机会已用完，赶紧去邀请好友注册赢得新的抽奖机会吧"):$(".myRecordDiv p:nth-of-type(1)").html('当前还剩余<span class="lotteryNum">'+t+"</span>次抽奖机会")}}):$(".myRecordDiv p:nth-of-type(1)").html("请先登录！！")},getCjMemberResultList:function(e){var e=e||1,t=10;$.ajax({type:"post",url:WX_ROOT+"usercenter/queryCjResult",data:{pageNumber:e,pageSize:t},success:function(e,t){var o=Handlebars.compile($("#winListDiv").html()),n=Handlebars.compile($("#adListDiv").html());$(".ad ul").html(n(JSON.parse(e).detail.list)),$(".listDiv").html(o(JSON.parse(e).detail.list))}})},author:function(){var e,t=window.location.href.split("#")[0];luckyLottery.options.signature||$.ajax({async:!1,data:{url:t},type:"GET",url:WX_ROOT+"wechat/signature",beforSend:function(){common.alert({stayTime:-1})},success:function(t){if(t){var o=JSON.parse(t);luckyLottery.options.signature=o.signature,luckyLottery.options.nonceStr=o.nonceStr,luckyLottery.options.timestamp=o.timestamp,luckyLottery.options.appid=o.appid;var n=localStorage.getItem("userInfo");if(n&&"testUser"!=n){var r=JSON.parse(n);e="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+luckyLottery.options.appid+"&redirect_uri="+window.location.href.split("?")[0]+"&state="+r.mobile+"&response_type=code&scope=snsapi_base#wechat_redirect"}else e="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+luckyLottery.options.appid+"&redirect_uri="+window.location.href.split("?")[0]+"&response_type=code&scope=snsapi_base#wechat_redirect"}else common.tips({msg:"系统繁忙,获取signature失败!"})},complete:function(){common.alert({show:!1})}}),luckyLottery.share(luckyLottery.options.appid,luckyLottery.options.timestamp,luckyLottery.options.signature,luckyLottery.options.nonceStr,e)},share:function(e,t,o,n,r){wx.config({debug:!1,appId:e,timestamp:t,nonceStr:n,signature:o,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"]}),wx.ready(function(){var e="http://www.szqhflkj.cn/weixin/static/img/indexShare.jpg",t="买车险，找达农，Get您的私人车管家！",o="比价、投保、理赔、救援、专人专服，这么贴心还不约么~";wx.onMenuShareTimeline({title:t,link:r,imgUrl:e,success:function(){common.showId($(".shareSuccessfulTipSection")),common.saveShareRecord(t,o,r,e,1)}}),wx.onMenuShareAppMessage({title:t,desc:o,link:r,imgUrl:e,success:function(){common.showId($(".shareSuccessfulTipSection")),common.saveShareRecord(t,o,r,e,2)}})}),wx.error(function(e){common.tips({msg:"唉哟，分享出错了。亲重新试一次吧！",callback:function(){location.reload()}})})},bind:function(){$(".registerBtn").on("tap",function(){window.location.href=WX_ROOT+"base/regist"}),$(".inviteBtn").on("tap",function(){common.showId($(".shareSection"))}),$(".shareSection .morLayerDiv").on("tap",function(){common.close($(".shareSection"))}),$(".loginBtn").on("tap",function(){window.location.href=WX_ROOT+"base/login"});var e=common.getUrlParameter("state");e&&localStorage.setItem("inviteMobile",e);var t=localStorage.getItem("token");$(".btnDiv").on("tap",function(){t?window.location.href=WX_ROOT+"insurance/insureResult":common.showId($(".loginTipSection"))}),$(".arrowDiv1").on("tap",function(){t?luckyLottery.lottery(t):common.showId($(".loginTipSection"))}),$(".myrecord").on("tap",function(){var e=localStorage.getItem("token");e?window.location.href=WX_ROOT+"usercenter/myWinRecord":common.showId($(".loginTipSection"))}),$(".closeBtn").on("tap",function(){common.close($(".lotteryResultDiv")),common.close($(".loginTipSection"))}),$(".iKnowBtn").on("tap",function(){common.close($(".lotteryResultDiv"))})}};$(document).ready(function(){var e=localStorage.getItem(CLEAR_FLAG_KEY),t=localStorage.getItem("mobile"),o=localStorage.getItem("userInfo"),n=new Date(ENV_DATE).getTime();if(o&&!e){localStorage.clear(),sessionStorage.clear(),t&&localStorage.setItem("mobile",t);var r=common.getUrlParameter("state");r&&localStorage.setItem("inviteMobile",r),localStorage.setItem(CLEAR_FLAG_KEY,n),localStorage.setItem("userInfo","testUser"),luckyLottery.enterWxAuthor()}else localStorage.setItem(CLEAR_FLAG_KEY,n),luckyLottery.enterWxAuthor()});
var center={init:function(){center.bind()},options:{height:window.innerHeight-458},enterWxAuthor:function(){var e=localStorage.getItem("wxUserInfo");if(e)center.init();else{var t=common.getUrlParameter("code");t?(common.getWxUserInfo(),center.init()):window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+WX_APPID+"&redirect_uri="+window.location.href+"&response_type=code&scope=snsapi_userinfo#wechat_redirect"}},getMyLotteryCount:function(e){$.ajax({data:{token:e},type:"POST",url:WX_ROOT+"usercenter/queryUserLeftLotteryCount",success:function(e){try{var t=JSON.parse(e);600==t.msgCode?(0==t.detail?$("#lastCountSpan").html("您的抽奖机会已用完"):$("#lastCountSpan").html('剩余<span class="lastCount">'+t.detail+"</span>次抽奖"),$("#lastCountSpan").addClass("lastCountSpan")):610==t.msgCode&&common.tips({msg:"身份验证过期，请重新登录！",updateText:!0,stayTime:2e3,callback:function(){window.location.href=WX_ROOT+"base/login"}})}catch(e){}}})},queryIsWeixinAuthorize:function(e){var t=localStorage.getItem("wxUserInfo"),o=!1;if(t){var n=JSON.parse(t);try{$.ajax({async:!1,data:{openid:n.openid},type:"GET",url:WX_ROOT+"wechat/queryIsWeixinAuthorize",success:function(e){if(e){var t=JSON.parse(e);"true"!=t.detail&&1!=t.detail||(o=!0)}}})}catch(e){}if(!o){var a=localStorage.getItem("userInfo"),e={};if(a){var i=JSON.parse(a);e.mobile=i.mobile,e.openid=n.openid,e.sex=n.sex,e.city=n.city,e.country=n.country,e.headimgurl=n.headimgurl,e.nickname=n.nickname,e.province=n.province,e.language=n.language,e.privilege=n.privilege,$.ajax({data:{jsonData:JSON.stringify(e)},type:"POST",url:WX_ROOT+"wechat/saveUserWeixin",success:function(e){if(e){var t=JSON.parse(e.data);600==t.msgCode&&common.tips({msg:"刷新微信授权信息成功"})}}})}}}},bind:function(){$(".insuranceDiv").css("height",center.options.height);var e=localStorage.getItem("token");e&&center.getMyLotteryCount(e),$(".editBtnDiv,.headerImgDiv>img").on("tap",function(t){e?window.location.href=WX_ROOT+"usercenter/centerInfo":common.tips({msg:"请先登录哦！",callback:function(){window.location.href=WX_ROOT+"base/login"}})}),$(".perfectData").on("tap",function(){window.location.href=WX_ROOT+"usercenter/perfectPersonalData"}),$(".mySocreDiv").on("tap",function(e){var o=localStorage.getItem("token");o?0!=t.detail?window.location.href=WX_ROOT+"usercenter/luckyLottery":common.tips({msg:"您的抽奖次数已用完！"}):common.tips({msg:"请先登录哦！",callback:function(){window.location.href=WX_ROOT+"base/login"}})}),$(".titleDiv").on("tap",function(t){localStorage.setItem("policyStatus","all"),e?window.location.href=WX_ROOT+"usercenter/myInsurancePolicy":common.tips({msg:"请先登录哦！",callback:function(){window.location.href=WX_ROOT+"base/login"}})}),$(".waitDiv").on("tap",function(){localStorage.setItem("policyStatus",0),e?window.location.href=WX_ROOT+"usercenter/myInsurancePolicy":common.tips({msg:"请先登录哦！",callback:function(){window.location.href=WX_ROOT+"base/login"}})}),$(".workDiv").on("tap",function(){localStorage.setItem("policyStatus",3),e?window.location.href=WX_ROOT+"usercenter/myInsurancePolicy":common.tips({msg:"请先登录哦！",callback:function(){window.location.href=WX_ROOT+"base/login"}})}),$(".finishDiv").on("tap",function(){localStorage.setItem("policyStatus",4),e?window.location.href=WX_ROOT+"usercenter/myInsurancePolicy":common.tips({msg:"请先登录哦！",callback:function(){window.location.href=WX_ROOT+"base/login"}})});var t=JSON.parse(localStorage.getItem("wxUserInfo"));t&&$(".headerImgDiv img").attr("src",t.headimgurl);var o=localStorage.getItem("userInfo"),n=$(".user-tel");if(o)try{var t=JSON.parse(o);n.html(t.mobile)}catch(e){n.html('<a href="'+WX_ROOT+'base/login" style="color: #f1eff0;">登录/注册</a>')}else n.html('<a href="'+WX_ROOT+'base/login" style="color: #f1eff0;">登录/注册</a>')}};$(document).ready(function(){var e=localStorage.getItem(CLEAR_FLAG_KEY),t=localStorage.getItem("mobile"),o=localStorage.getItem("userInfo"),n=new Date(ENV_DATE).getTime();o&&!e?(localStorage.clear(),sessionStorage.clear(),t&&localStorage.setItem("mobile",t),localStorage.setItem(CLEAR_FLAG_KEY,n),localStorage.setItem("userInfo","testUser"),center.init()):(localStorage.setItem(CLEAR_FLAG_KEY,n),center.init())});
var center={init:function(){center.tab(),center.initData(),center.registerHelper(),center.bind()},options:{token:localStorage.getItem("token"),userId:null,height:window.innerHeight-458,status:localStorage.getItem("policyStatus")},tab:function(){var t=new fz.Scroll(".ui-tab",{role:"tab",autoplay:!1,interval:3e3});t.on("beforeScrollStart",function(t,e){}),t.on("scrollEnd",function(t){var e=0;0==t?(e="",localStorage.setItem("policyStatus","all")):1==t?(e=0,localStorage.setItem("policyStatus",0)):2==t?(e=3,localStorage.setItem("policyStatus",3)):3==t&&(e=4,localStorage.setItem("policyStatus",4)),center.getList(e,1e3)})},registerHelper:function(){Handlebars.registerHelper("status",function(t,e){return t=JSON.parse(t),0==t?"待支付":1==t?"已支付":2==t?"已出单":3==t?"已生效":4==t?"已终止":5==t?"已拒保":6==t?"已取消":void 0}),Handlebars.registerHelper("pic",function(t,e){return PIC_PATH+t}),Handlebars.registerHelper("payClass",function(t,e){return"0"==t||"3"==t||"4"==t||"5"==t||"6"==t?"":"dis_none"}),Handlebars.registerHelper("tellClass",function(t,e){return"3"==t?"":"dis_none"}),Handlebars.registerHelper("notTellClass",function(t,e){return"0"==t?"":"dis_none"}),Handlebars.registerHelper("delClass",function(t,e){return"4"==t||"5"==t||"6"==t?"":"dis_none"}),Handlebars.registerHelper("jq",function(t,e){return""==t||null==t?"dis_none":""}),Handlebars.registerHelper("sy",function(t,e){return""==t||null==t?"dis_none":""})},initData:function(){var t=localStorage.getItem("policyStatus");3==t?(localStorage.setItem("policyStatus",3),$(".ui-tab-nav li:nth-of-type(3)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content li:nth-of-type(3)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content").css({transform:"translate(-1280px, 0px)","-webkit-transform":"translate(-1280px, 0px)"}),center.getList(t,1e3)):4==t?(localStorage.setItem("policyStatus",4),$(".ui-tab-nav li:nth-of-type(4)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content li:nth-of-type(4)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content").css({transform:"translate(-1920px, 0px)","-webkit-transform":"translate(-1920px, 0px)"}),center.getList(t,1e3)):0==t?(localStorage.setItem("policyStatus",0),$(".ui-tab-nav li:nth-of-type(2)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content li:nth-of-type(2)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content").css({transform:"translate(-640px, 0px)","-webkit-transform":"translate(-640px, 0px)"}),center.getList(t,1e3)):(localStorage.setItem("policyStatus","all"),$(".ui-tab-nav li:nth-of-type(1)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content li:nth-of-type(1)").addClass("current").siblings().removeClass("current"),$(".ui-tab-content").css({transform:"translate(0px, 0px)","-webkit-transform":"translate(0px, 0px)"}),center.getList("",1e3))},getList:function(t,e){var a=e||1,n=10;$.ajax({data:{token:center.options.token,userId:center.options.userId,type:t,pageNumber:a,pageSize:n},type:"get",url:WX_ROOT+"insurance/getOrderList",beforeSend:function(){common.alert({stayTime:-1})},success:function(t){if(t)try{var e=JSON.parse(t),a=[],n=0;if(e&&600==e.code)if(e.data.list.length>0){for(var r=Handlebars.compile($("#listDiv2").html()),o=0;o<e.data.list.length;o++){var i={},s=[];i.id=e.data.list[o].id,i.paulId=e.data.list[o].paulId,i.pid=e.data.list[o].pid,i.pname=e.data.list[o].pname,i.STATUS=e.data.list[o].STATUS,i.type=e.data.list[o].type,i.imageUrl=e.data.list[o].imageUrl,i.created=e.data.list[o].created,i.feeTotal=e.data.list[o].feeTotal,i.ordersId=e.data.list[o].ordersId,i.orderType=e.data.list[o].orderType,i.telephone=e.data.list[o].telephone,i.flag=JSON.stringify(s),i.productCount=e.data.list[o].pcount,i.productPrice=e.data.list[o].pprice,a.push(i),n++}0==n&&common.tips({msg:"没有您的车险订单"}),3==localStorage.getItem("policyStatus")?$(".workDiv").html(r(a)):4==localStorage.getItem("policyStatus")?$(".finishDiv").html(r(a)):0==localStorage.getItem("policyStatus")?$(".waitDiv").html(r(a)):$(".allDiv").html(r(a))}else common.tips({msg:"没有数据"});else common.tips({msg:e.msg})}catch(t){}common.alert({show:!1})}})},delOrder:function(t,e){var a={};a.oid=t,a.token=e,$.ajax({url:WX_CORS,data:{url:"rest/app/order/cancel",params:JSON.stringify(a)},type:"POST",success:function(t){600==t.code?(common.close($(".delSection")),window.location.href=window.location.href):common.error()},timeout:3e3})},delPolicy:function(t,e){var a={};a.oid=t,a.token=e,$.ajax({url:WX_CORS,data:{url:"rest/app/order/delete",params:JSON.stringify(a)},type:"POST",success:function(t){600==t.code?(common.close($(".delSection")),window.location.href=window.location.href):common.error()},timeout:3e3})},bind:function(){$(".insuranceDiv").css("height",center.options.height),$(".workDiv ").off().on("tap",".orderInfoDiv",function(){localStorage.setItem("policyStatus","all");var t=$(this).parents("li").attr("data-id"),e=$(this).parents("li").attr("data-ordertype"),a=$(this).parents("li").attr("data-phone");sessionStorage.setItem("myInsurancePolicy_id",t),1==e?window.location.href=WX_ROOT+"usercenter/insureDetail":window.location.href=WX_ROOT+"usercenter/notCarInsureDetail?myInsurancePolicy_id="+t+"&phone="+a}),$(".finishDiv ").off().on("tap",".orderInfoDiv",function(){localStorage.setItem("policyStatus","all");var t=$(this).parents("li").attr("data-id"),e=$(this).parents("li").attr("data-ordertype"),a=$(this).parents("li").attr("data-phone");sessionStorage.setItem("myInsurancePolicy_id",t),1==e?window.location.href=WX_ROOT+"usercenter/insureDetail":window.location.href=WX_ROOT+"usercenter/notCarInsureDetail?myInsurancePolicy_id="+t+"&phone="+a}),$(".waitDiv ").off().on("tap",".orderInfoDiv",function(){localStorage.setItem("policyStatus","all");var t=$(this).parents("li").attr("data-id"),e=$(this).parents("li").attr("data-ordertype"),a=$(this).parents("li").attr("data-phone");sessionStorage.setItem("myInsurancePolicy_id",t),1==e?window.location.href=WX_ROOT+"usercenter/insureDetail":window.location.href=WX_ROOT+"usercenter/notCarInsureDetail?myInsurancePolicy_id="+t+"&phone="+a}),$(".allDiv ").off().on("tap",".orderInfoDiv",function(){localStorage.setItem("policyStatus","all");var t=$(this).parents("li").attr("data-id"),e=$(this).parents("li").attr("data-ordertype"),a=$(this).parents("li").attr("data-phone");sessionStorage.setItem("myInsurancePolicy_id",t),1==e?window.location.href=WX_ROOT+"usercenter/insureDetail":window.location.href=WX_ROOT+"usercenter/notCarInsureDetail?myInsurancePolicy_id="+t+"&phone="+a}),$("body").on("tap",".rightBtn",function(){var t=$(this).parents("li").attr("data-ordersid"),e=$(this).parents("li").attr("data-proid"),a=$(this).parents("li").attr("data-productPrice"),n=$(this).parents("li").attr("data-productCount"),r=$(this).parents("li").attr("data-productName");4==e||5==e||6==e?window.location.href=WX_ROOT+"pay/tBbpayInfo?productPrice="+a+"&productCount="+n+"&productId="+t+"&productName="+r+"&createPay=0":window.location.href=APP_ROOT+"pay/kqPay?ordersId="+t}),$("body").on("tap",".cancelPayBtn",function(){common.showId($(".delSection")),$(".delBtnDiv p:nth-of-type(2)").addClass("ensureCancelBtn").removeClass("ensureDelBtn"),$(".delSection").attr("data-id",$(this).parents("li").attr("data-id")),$(".cancelDelBtn").on("tap",function(){common.close($(".delSection"))}),$(".ensureCancelBtn").on("tap",function(){var t=$(this).parents(".delSection").attr("data-id");center.delOrder(t,center.options.token)})}),$("body").on("tap",".deletePolicyBtn",function(){$(".bgDiv p.titleP").text("确定删除此订单吗"),$(".delBtnDiv p:nth-of-type(2)").addClass("ensureDelBtn").removeClass("ensureCancelBtn"),common.showId($(".delSection")),$(".delSection").attr("data-id",$(this).parents("li").attr("data-id")),$(".cancelDelBtn").on("tap",function(){common.close($(".delSection"))}),$(".ensureDelBtn").on("tap",function(){var t=$(this).parents(".delSection").attr("data-id");center.delPolicy(t,center.options.token)})})}};$(document).ready(function(){var t=localStorage.getItem("userInfo");if(t)try{var e=JSON.parse(t);e&&e.id?(center.options.userId=e.id,center.init()):window.location.href=WX_ROOT+"info/500"}catch(t){window.location.href=WX_ROOT+"info/500"}else window.location.href=WX_ROOT+"base/login"});
var winRecord={init:function(){winRecord.bind(),winRecord.registerHelper(),winRecord.getRecord(localStorage.getItem("token"),"1","20"),winRecord.getTotalNum(localStorage.getItem("token"))},options:{},registerHelper:function(){Handlebars.registerHelper("status",function(e,t){return 0==e?"待发放":1==e?"已发放":void 0}),Handlebars.registerHelper("time",function(e,t){return new Date(parseInt(e)).toLocaleString().replace(/:\d{1,2}$/," ")})},getRecord:function(e,t,n){$.ajax({data:{token:e,pageNumber:t,pageSize:n},type:"get",url:WX_ROOT+"usercenter/queryUserCjResult",beforeSend:function(){},success:function(e){if(600==JSON.parse(e).msgCode){var t=(JSON.parse(e).detail.list.length,Handlebars.compile($("#listDiv").html()));$(".allList").html(t(JSON.parse(e).detail.list)),$(".win").text(JSON.parse(e).detail.total)}else 610==JSON.parse(e).msgCode?common.tips({msg:"身份验证过期，请重新登录！",updateText:!0,stayTime:2e3,callback:function(){window.location.href=WX_ROOT+"base/login"}}):common.tips({msg:data.msg})}})},getTotalNum:function(e){$.ajax({data:{token:e},type:"get",url:WX_ROOT+"usercenter/queryCjResultCountByUserId",beforeSend:function(){common.alert({stayTime:-1})},success:function(e){600==JSON.parse(e).msgCode?$(".had").text(JSON.parse(e).detail):610==JSON.parse(e).msgCode?common.tips({msg:"身份验证过期，请重新登录！",updateText:!0,stayTime:2e3,callback:function(){window.location.href=WX_ROOT+"base/login"}}):common.tips({msg:data.msg}),common.alert({show:!1})}})},bind:function(){$(".btnDiv").on("tap",function(){window.location.href=WX_ROOT+"insurance/insureResult"}),$(".lotteryBtn").on("tap",function(){luckyLottery.lottery()}),$(".iKnowBtn").on("tap",function(){common.close($(".lotteryResultDiv"))})}};$(document).ready(function(){winRecord.init()});
var perfectPersonalData={init:function(){var e=perfectPersonalData;e.bind(),e.initHtml()},options:{editData:null,editId:null,updateUserFlag:sessionStorage.getItem("updateUserFlag"),defaultProvienceId:5,defaultCityId:76,height:window.innerHeight-458},initHtml:function(){var e=perfectPersonalData,t=JSON.parse(localStorage.getItem("userInfo")),a=$(".headerSpan"),s=$(".InputsDiv"),n=[];switch(parseInt(perfectPersonalData.options.updateUserFlag)){case 1:a.html("修改地址"),n.push('<div class="singleRow border_bottom">'),n.push('<select class="provienceInput areaInput fl" id="provienceSelect">'),n.push('<option value="-1">加载中..</option>'),n.push("</select>"),n.push('<select class="cityInput areaInput fl" id="citySelect">'),n.push('<option value="-1">加载中..</option>'),n.push("</select>"),n.push("</div>"),n.push('<div class="singleRow border_bottom">'),n.push('<input class="addressInput" placeholder="请输入详细地址（收货地址）">'),n.push("</div>"),s.html(n.join("")),e.provience(),e.city(e.options.defaultProvienceId),$("#provienceSelect").val(e.options.defaultProvienceId),$("#citySelect").val(e.options.defaultCityId),$(".provienceInput").on("change",function(){var e=$(".provienceInput").val();perfectPersonalData.city(e)}),$(".addressInput").val(t.address);break;case 2:a.html("修改姓名"),n.push('<div class="singleRow border_bottom">'),n.push('<input class="nameInput" placeholder="请输入您的真实姓名">'),n.push("</div>"),s.html(n.join("")),$(".nameInput").val(t.realName);break;case 3:a.html("修改邮箱"),n.push('<div class="singleRow border_bottom">'),n.push('<input class="emailInput" placeholder="请输入您的邮箱">'),n.push("</div>"),s.html(n.join("")),$(".emailInput").val(t.email);break;case 4:a.html("修改证件号码"),n.push('<div class="singleRow border_bottom">'),n.push('<input class="idCardInput" placeholder="请输入您的证件号码">'),n.push("</div>"),s.html(n.join("")),$(".idCardInput").val(t.idCard);break;case 5:n.push('<div class="singleRow border_bottom">'),n.push('<input class="userNameInput" placeholder="姓名">'),n.push("</div>"),n.push('<div class="singleRow border_bottom">'),n.push('<input class="phoneNumberInput" placeholder="手机号">'),n.push("</div>"),n.push('<div class="singleRow border_bottom">'),n.push('<select class="provienceInput areaInput fl" id="provienceSelect">'),n.push('<option value="-1">加载中..</option>'),n.push("</select>"),n.push('<select class="cityInput areaInput fl" id="citySelect">'),n.push('<option value="-1">加载中..</option>'),n.push("</select>"),n.push("</div>"),n.push('<div class="singleRow border_bottom">'),n.push('<input class="addressInput" placeholder="请输入详细地址（收货地址）">'),n.push("</div>"),n.push('<div class="singleRow border_bottom">'),n.push('<p class="fl">设置为默认地址</p><div class="rightInput fr">'),n.push('<input name="isTransfer" type="hidden" value="0" class="isHostInput">'),n.push('<i class="checkBtn checkOffImg"></i></div>'),n.push("</div>"),s.html(n.join("")),e.provience(),e.city(e.options.defaultProvienceId);var o=localStorage.getItem("editData");if(o){var i=JSON.parse(o);$(".userNameInput").val(i.receiver),$(".phoneNumberInput").val(i.mobile),$(".provienceInput").val(i.provinceId),perfectPersonalData.city(i.provinceId),$(".cityInput").val(i.cityId),$(".addressInput").val(i.address),e.options.editId=i.id,e.options.editData=!0,1==i.isDefault&&$(".checkBtn").removeClass("checkOffImg").addClass("checkOnImg"),localStorage.removeItem("editData")}else $("#provienceSelect").val(e.options.defaultProvienceId),$("#citySelect").val(e.options.defaultCityId);$(".provienceInput").on("change",function(){var e=$(".provienceInput").val();perfectPersonalData.city(e)})}},city:function(e){$.ajax({async:!1,data:{type:"city",provinceId:e},type:"GET",url:WX_ROOT+"insurance/queryProvinceList",beforSend:function(){common.alert({stayTime:-1})},success:function(e){try{var t=JSON.parse(e);if(600==t.code){var t=JSON.parse(e),a="";$(t.data).each(function(e,t){a+="<option value="+t.id+">"+t.name+"</option>"}),$("#citySelect").html(a)}common.alert({show:!1})}catch(e){common.tips({msg:"系统繁忙"})}}})},provience:function(){$.ajax({async:!1,data:{type:"province"},type:"GET",url:WX_ROOT+"insurance/queryProvinceList",beforSend:function(){common.alert({stayTime:-1})},success:function(e){try{var t=JSON.parse(e);if(600==t.code){var t=JSON.parse(e),a="";$(t.data).each(function(e,t){a+="<option value="+t.id+">"+t.name+"</option>"}),$("#provienceSelect").html(a)}common.alert({show:!1})}catch(e){common.tips({msg:"系统繁忙"})}}})},addAddress:function(e,t){var a={};a.token=e,a.flag=2,a.receiver=$(".userNameInput").val().trim(),a.mobile=$(".phoneNumberInput").val().trim(),a.provinceId=$(".provienceInput").val().trim(),a.province=$(".provienceInput").children(":checked").text().trim(),a.cityId=$(".cityInput").val().trim(),a.city=$(".cityInput").children(":checked").text().trim(),a.address=$(".addressInput").val().trim();var s=$(".checkBtn").hasClass("checkOnImg");s?a.isDefault=1:a.isDefault=0,"edit"==t?(a.setType=2,a.id=perfectPersonalData.options.editId):"add"==t&&(a.setType=1),$.ajax({data:a,type:"POST",url:WX_ROOT+"usercenter/userAddress",beforeSend:function(){common.tips({msg:"请稍后.."})},success:function(e){var t=JSON.parse(e);600==t.msgCode?common.tips({msg:"保存成功",updateText:!0,stayTime:1500,callback:function(){window.location.href=WX_ROOT+"usercenter/receiveAddress"}}):610==t.msgCode&&common.tips({msg:"身份验证过期，请重新登录！",updateText:!0,stayTime:2e3,callback:function(){localStorage.setItem("toRegistPage",window.location.href),window.location.href=WX_ROOT+"base/login"}})}})},save:function(e,t){var a={};switch(a.token=e,parseInt(perfectPersonalData.options.updateUserFlag)){case 1:a.flag=1,a.provience=$(".provienceInput :checked").text(),a.city=$(".cityInput :checked").text(),a.address=$(".addressInput").val();break;case 2:a.flag=2,a.username=$(".nameInput").val();break;case 3:a.flag=3,a.email=$(".emailInput").val();break;case 4:a.flag=4,a.idCardNumber=$(".idCardInput").val();break;case 5:a.flag=5;break;case 6:a.flag=6}5==a.flag?perfectPersonalData.options.editData?perfectPersonalData.addAddress(e,"edit"):perfectPersonalData.addAddress(e,"add"):$.ajax({data:a,type:"POST",url:WX_ROOT+"usercenter/updateUserInfo",beforeSend:function(){common.tips({msg:"请稍后.."})},success:function(t){var a=JSON.parse(t.data);600==a.msgCode?common.tips({msg:"修改成功",updateText:!0,stayTime:500,callback:function(){common.queryUserByToken(e);var t=localStorage.getItem("toAdressPage");t?(window.location.href=t,localStorage.removeItem("toAdressPage")):window.location.href=WX_ROOT+"usercenter/centerInfo"}}):610==a.msgCode&&common.tips({msg:"身份验证过期，请重新登录！",updateText:!0,stayTime:2e3,callback:function(){localStorage.setItem("toRegistPage",window.location.href),window.location.href=WX_ROOT+"base/login"}})}})},bind:function(){$(".insuranceDiv").css("height",perfectPersonalData.options.height),$(".ensureBtn").on("tap",function(){var e=localStorage.getItem("token");e?perfectPersonalData.save(e):common.tips({msg:"没有登录",callback:function(){window.location.href=WX_ROOT+"base/login"}})}),$(".contentDiv ").on("tap",".checkBtn",function(){$(this).hasClass("checkOnImg")?$(this).removeClass("checkOnImg").addClass("checkOffImg"):$(this).removeClass("checkOffImg ").addClass("checkOnImg")})}};$(document).ready(function(){perfectPersonalData.init()});
var receiveAddress={init:function(){receiveAddress.registerHelper();var e=localStorage.getItem("token");e&&receiveAddress.getUserAddress(e),receiveAddress.bind()},registerHelper:function(){Handlebars.registerHelper("isDefault",function(e){return 1==e?"color-red":"color-white"})},getUserAddress:function(e){$.ajax({async:!1,data:{token:e,flag:1},type:"GET",url:WX_ROOT+"usercenter/userAddress",beforeSend:function(){common.alert({stayTime:-1})},success:function(e){if(e){sessionStorage.setItem("userAddress",e);var t=JSON.parse(e);if(600==t.msgCode)if(t.detail&&t.detail.length>0){var s=Handlebars.compile($("#listDiv").html());$(".contentDiv").html(s(t.detail))}else $(".contentDiv").text("亲暂时还没有收货地址哦，请点击右上角添加一个吧！").addClass("no-add-data");else 610==t.msgCode&&common.tips({msg:"身份验证过期，请重新登录！",updateText:!0,stayTime:2e3,callback:function(){localStorage.setItem("toRegistPage",window.location.href),window.location.href=WX_ROOT+"base/login"}})}common.alert({show:!1})}})},deleteAddress:function(e,t){$.ajax({data:{token:e,flag:2,setType:3,id:t},type:"POST",url:WX_ROOT+"usercenter/userAddress",success:function(e){$("#address-panel"+t).addClass("dis_none"),common.tips({msg:"删除成功"}),common.close($(".delSection"))}})},options:{},bind:function(){$(".addSpan").on("touchend",function(){sessionStorage.setItem("updateUserFlag",5),window.location.href=WX_ROOT+"usercenter/perfectPersonalData"}),$(".delete").on("touchend",function(e){common.showId($(".delSection")),$(".delSection").attr("data-id",$(e.currentTarget).attr("data-id")),e.stopPropagation(),e.preventDefault()}),$(".cancelDelBtn").on("touchend",function(){common.close($(".delSection"))}),$(".ensureDelBtn").on("touchend",function(){var e=localStorage.getItem("token"),t=$(".delSection").attr("data-id");e&&receiveAddress.deleteAddress(e,t)}),$(".edit").on("touchend",function(e){e.stopPropagation(),e.preventDefault();var t=JSON.parse(sessionStorage.getItem("userAddress")),s=$(e.currentTarget).attr("data-id");sessionStorage.setItem("updateUserFlag",5),$(t.detail).each(function(e,t){s==t.id&&localStorage.setItem("editData",JSON.stringify(t))}),window.location.href=WX_ROOT+"usercenter/perfectPersonalData"}),$(".address-panel").on("tap",function(e){var t=$(e.currentTarget).attr("data-addressId");localStorage.setItem("addressId",t);var s=JSON.parse(sessionStorage.getItem("userAddress"));$(s.detail).each(function(e,s){t==s.id&&sessionStorage.setItem("selectedAddress",JSON.stringify(s))});var n=sessionStorage.getItem("toAdressPage");n&&(window.location.href=n)})}};$(document).ready(function(){receiveAddress.init()});
var share={init:function(){share.registerHelper(),share.getList(),share.bind()},registerHelper:function(){Handlebars.registerHelper("rank",function(e){return this._index=e+1,this._index}),Handlebars.registerHelper("nickname",function(e,t){return""==e||null==e?"--":e}),Handlebars.registerHelper("headImg",function(e,t){return""==e||null==e?WX_STATIC+"img/logo.png":e})},getList:function(){$.ajax({type:"GET",url:WX_ROOT+"usercenter/queryUserInviteList",beforeSend:function(){common.alert({stayTime:-1})},success:function(e){if(e){var t=JSON.parse(e),r=Handlebars.compile($("#list-top-ten").html());$(".listDataDiv").html(r(t));for(var i=0;i<$(".singleDiv").length;i++){var o=$(".singleDiv").eq(i).attr("data-index");1!=o&&4!=o&&15!=o||$(".singleDiv").eq(i).css("border-bottom","1px solid #ccc")}}else common.tips({msg:"暂无数据"});common.alert({show:!1})}})},bind:function(){$(".prizeSection .morLayerDiv").off().on("tap",function(){common.close($(".prizeSection"))}),$(".closeBtn").off().on("tap",function(){common.close($(".cheatSection"))}),$(".listDataDiv").off().on("tap",".singleDiv",function(){common.showId($(".prizeSection"));var e=$(this).attr("data-index");1==e?$(".prizeSection .morLayerDiv").append('<img class="tipsImg" src='+WX_STATIC+"img/shareNum1.jpg>"):e>1&&e<=4?$(".prizeSection .morLayerDiv").append('<img class="tipsImg" src='+WX_STATIC+"img/shareNum2.jpg>"):$(".prizeSection .morLayerDiv").append('<img class="tipsImg" src='+WX_STATIC+"img/shareNum3.jpg>")})}};$(document).ready(function(){var e=localStorage.getItem(CLEAR_FLAG_KEY),t=localStorage.getItem("mobile"),r=localStorage.getItem("userInfo"),i=new Date(ENV_DATE).getTime();if(r&&!e){localStorage.clear(),sessionStorage.clear(),t&&localStorage.setItem("mobile",t);var o=common.getUrlParameter("state");o&&localStorage.setItem("inviteMobile",o),localStorage.setItem(CLEAR_FLAG_KEY,i),localStorage.setItem("userInfo","testUser"),share.init()}else localStorage.setItem(CLEAR_FLAG_KEY,i),share.init()});
var uploadPhoto={init:function(){uploadPhoto.author(),uploadPhoto.bind()},options:{signature:null,timestamp:null,nonceStr:null,appid:null},author:function(){var o,t=window.location.href.split("#")[0];uploadPhoto.options.signature||$.ajax({async:!1,data:{url:t},type:"GET",url:WX_ROOT+"wechat/signature",beforSend:function(){common.alert({stayTime:-1})},success:function(o){var t=JSON.parse(o);uploadPhoto.options.signature=t.signature,uploadPhoto.options.nonceStr=t.nonceStr,uploadPhoto.options.timestamp=t.timestamp,uploadPhoto.options.appid=t.appid},complete:function(){common.alert({show:!1})}}),uploadPhoto.share(uploadPhoto.options.appid,uploadPhoto.options.timestamp,uploadPhoto.options.signature,uploadPhoto.options.nonceStr,o)},share:function(o,t,n,a,i){wx.config({debug:!0,appId:o,timestamp:t,nonceStr:a,signature:n,jsApiList:["chooseImage","previewImage","uploadImage","downloadImage"]}),wx.ready(function(){}),wx.error(function(o){common.tips({msg:"获取授权证书失败！"})})},bind:function(){$(".upload-photo").on("tap",function(){wx.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(o){common.tips({msg:o.localIds}),$(".id-card img").prop("src",o.localIds[0])}})})}};$(document).ready(function(){uploadPhoto.init()});